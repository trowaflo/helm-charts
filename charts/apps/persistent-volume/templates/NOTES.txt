Thank you for installing {{ .Chart.Name }}!

{{- $pvCount := 0 }}
{{- range $key, $config := .Values.persistentVolumes }}
  {{- if $config.enabled }}
    {{- $pvCount = add $pvCount 1 }}
  {{- end }}
{{- end }}

{{- $pvcCount := 0 }}
{{- range $key, $config := .Values.persistentVolumeClaims }}
  {{- if $config.enabled }}
    {{- $pvcCount = add $pvcCount 1 }}
  {{- end }}
{{- end }}

Resources created:
  - PersistentVolumes: {{ $pvCount }}
  - PersistentVolumeClaims: {{ $pvcCount }}

{{- if gt $pvCount 0 }}

PersistentVolumes:
{{- range $key, $config := .Values.persistentVolumes }}
{{- if $config.enabled }}
  - {{ include "persistent-volume.pvName" (dict "key" $key "config" $config "root" $) }}
    {{- with $config.capacity }}
    Capacity: {{ . }}
    {{- end }}
    {{- with $config.storageClassName }}
    StorageClass: {{ . }}
    {{- end }}
{{- end }}
{{- end }}

To view PersistentVolumes:
  kubectl get pv
{{- end }}

{{- if gt $pvcCount 0 }}

PersistentVolumeClaims:
{{- range $key, $config := .Values.persistentVolumeClaims }}
{{- if $config.enabled }}
  {{- $namespace := default $.Release.Namespace $config.namespace }}
  - {{ include "persistent-volume.pvcName" (dict "key" $key "config" $config "root" $) }} (namespace: {{ $namespace }})
    {{- with $config.resources.requests.storage }}
    Storage: {{ . }}
    {{- end }}
    {{- with $config.storageClassName }}
    StorageClass: {{ . }}
    {{- end }}
{{- end }}
{{- end }}

To view PersistentVolumeClaims:
  kubectl get pvc -A
{{- end }}

{{- if and (eq $pvCount 0) (eq $pvcCount 0) }}

No PersistentVolumes or PersistentVolumeClaims were created because all resources are disabled.
Please enable at least one resource in your values.yaml:
  persistentVolumes:
    my-volume:
      enabled: true
      ...
  persistentVolumeClaims:
    my-claim:
      enabled: true
      ...
{{- end }}

For more information about PersistentVolumes and PersistentVolumeClaims:
  https://kubernetes.io/docs/concepts/storage/persistent-volumes/
